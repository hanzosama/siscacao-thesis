<?xml version='1.0' encoding='UTF-8' ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <body>
        <ui:composition template="./../templatePortal.xhtml">
            <ui:define name="top">&nbsp;</ui:define>
            <ui:define name="content">
                <h:form>
                    <p:menubar>  
                        <p:menuitem value="#{msg.home}" url="#{appBean.baseURL}portal/index.jsf?faces-redirect=true"  styleClass="homesiscacao-icon" />  
                    </p:menubar>
                </h:form>
            </ui:define>
            <ui:define name="middle_content">
                <h:form id="form">
                    <p:messages id="msgs" closable="true"  />         
                    <p:ajaxStatus onstart="statusDialog.show();" onsuccess="statusDialog.hide();" >  
                        <p:dialog modal="true" widgetVar="statusDialog"   
                                  draggable="false" closable="false">  
                            <p:graphicImage value="#{appBean.baseURL}resources/gfx/ajax-loader.gif" />
                        </p:dialog> 
                    </p:ajaxStatus>
                    <p:wizard widgetVar="wiz" nextLabel="#{msg.lbl_next}" backLabel="#{msg.lbl_previous}" showStepStatus="false" >  
                        <p:tab id="personal" title="#{msg.title_personal_data}"  >
                            <p:panel id="panel" header="#{msg.title_personal_data}" style="margin-bottom:10px;">  
                                <h:panelGrid columns="3" cellpadding="2">
                                    <h:outputLabel value="#{msg.lbl_complete_name}" for="nombreSolicitante" style="font-weight: bold" />
                                    <p:inputText id="nombreSolicitante" value="#{solicitanteBean.solicitante.nombreSolicitante}" requiredMessage="#{msg.wrn_complete_name_req}" required="true" label="nombreSolicitante" disabled="#{solicitanteBean.isUserRegistered}"/>
                                    <p:message for="nombreSolicitante" />
                                    <h:outputLabel value="#{msg.lbl_departament}" for="departamento" style="font-weight: bold"/>
                                    <p:selectOneMenu id="departamento" value="#{solicitanteBean.selectedDepartamento}" required="true" requiredMessage="#{msg.wrn_departament_req}" filter="true" disabled="#{solicitanteBean.isUserRegistered}">  
                                        <f:selectItem itemLabel="seleccione" itemValue="" />  
                                        <f:selectItems value="#{solicitanteBean.listDepartamentos}" var="depto" itemLabel="#{depto.nombreDepartamento}" itemValue="#{depto.idDepartamento}"/>
                                    </p:selectOneMenu>
                                    <p:message for="departamento" />
                                    <h:outputLabel value="#{msg.lbl_document_type}" for="idTipoDocumento" style="font-weight: bold" />
                                    <p:selectOneMenu id="idTipoDocumento" value="#{solicitanteBean.selectedTipoDocumento}" disabled="#{solicitanteBean.isUserRegistered}">
                                        <f:selectItems value="#{solicitanteBean.listTblTipoDocumentos}" var="tipos" itemLabel="#{tipos.nombreTipo}-#{tipos.descripcionTipo}" itemValue="#{tipos.idTipoDocumento}" />
                                    </p:selectOneMenu>
                                    <p:column/>
                                    <h:outputLabel value="#{msg.number_document}" for="numeroDocumento" style="font-weight: bold" />
                                    <p:inputText id="numeroDocumento"  value="#{solicitanteBean.solicitante.numeroDocumento}" title="#{msg.number_document}" required="true" label="numeroDocumento" requiredMessage="#{msg.wrn_document_number_required}" converterMessage="#{msg.wrn_document_number_not_valid}" disabled="#{solicitanteBean.isUserRegistered}">
                                        <f:convertNumber type="number"/>
                                        <f:validateLength minimum="2" /> 
                                    </p:inputText>
                                    <p:message for="numeroDocumento" /> 
                                    <h:outputLabel value="#{msg.lbl_phone_1}" for="idContactoFijo" style="font-weight: bold"/>
                                    <p:inputText id="idContactoFijo"  value="#{solicitanteBean.telefonoFijo}" title="#{msg.lbl_phone_1}"  requiredMessage="#{msg.wrn_phone_1_required}" required="true"  disabled="#{solicitanteBean.isUserRegistered}">
                                    </p:inputText>
                                    <p:message for="idContactoFijo" />
                                    <h:outputLabel value="#{msg.lbl_phone_2}" for="idContactoMovil" style="font-weight: bold"/>
                                    <p:inputMask id="idContactoMovil" value="#{solicitanteBean.telefonoMovil}" mask="(999) 999-9999" required="true" requiredMessage="#{msg.wrn_phone_2_required}" disabled="#{solicitanteBean.isUserRegistered}"/>
                                    <p:message for="idContactoMovil" />
                                    <h:outputLabel value="#{msg.lbl_email}" for="idEmail" style="font-weight: bold" />
                                    <p:inputText id="idEmail" value="#{solicitanteBean.email}"  validatorMessage="#{msg.wrn_email_not_valid}" requiredMessage="#{msg.wrn_email_required}"  disabled="#{solicitanteBean.isUserRegistered}">
                                        <f:validateRegex pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                                    </p:inputText>
                                    <p:message for="idEmail" />
                                </h:panelGrid>
                            </p:panel>
                        </p:tab> 

                        <p:tab id="address" title="#{msg.title_crop_inf}">  
                            <p:panel id="panel2" header="#{msg.title_crop_inf}" style="margin-bottom:10px;">  
                                <h:panelGrid columns="3" cellpadding="2">
                                    <h:outputLabel value="#{msg.lbl_crop_name}" for="nombreCultivo" style="font-weight: bold"/>
                                    <p:inputText id="nombreCultivo" value="#{solicitanteBean.cultivo.nombreCultivo}" requiredMessage="#{msg.wrn_crop_required}" required="true" label="nombreCultivo"/>
                                    <p:message for="nombreCultivo" />                              

                                    <h:outputLabel value="#{msg.lbl_crop_ext}" for="extensionCultivo" style="font-weight: bold"/>
                                    <p:inputText id="extensionCultivo" value="#{solicitanteBean.cultivo.extensionCultivo}"  label="extensionCultivo"/>
                                    <p:message for="extensionCultivo" />  

                                    <h:outputLabel value="#{msg.lbl_weather}" for="nombreClima" style="font-weight: bold"/>
                                    <p:selectOneMenu id="nombreClima" value="#{solicitanteBean.selectedClima}">  
                                        <f:selectItem itemLabel="Seleccione" itemValue="" />  
                                        <f:selectItems value="#{solicitanteBean.listClima}" var="clima" itemLabel="#{clima.nombreClima}" itemValue="#{clima.idClima}"/>
                                    </p:selectOneMenu>
                                    <p:column/>

                                    <h:outputLabel value="#{msg.lbl_crop_age}" for="edadCultivo" style="font-weight: bold"/>
                                    <p:inputText id="edadCultivo" value="#{solicitanteBean.cultivo.edadCultivo}"  label="edadCultivo"/>
                                    <p:message for="edadCultivo"/>

                                    <h:outputLabel value="#{msg.lbl_crop_variety}" for="nombreVariedad" style="font-weight: bold"/>
                                    <p:selectOneMenu id="nombreVariedad" value="#{solicitanteBean.selectedVariedad}">  
                                        <f:selectItem itemLabel="Seleccione" itemValue="" />  
                                        <f:selectItems value="#{solicitanteBean.listVariedad}" var="variedad" itemValue="#{variedad.idVariedad}" itemLabel="#{variedad.nombreVariedad}" />
                                    </p:selectOneMenu>
                                    <p:column/>

                                    <h:outputLabel value="#{msg.lbl_crop_tech}" for="nombreTecnica" style="font-weight: bold"/>
                                    <p:selectOneMenu id="nombreTecnica" value="#{solicitanteBean.selectedTecnica}">  
                                        <f:selectItem itemLabel="Seleccione" itemValue="" />  
                                        <f:selectItems value="#{solicitanteBean.listTecnica}" var="tecnica" itemLabel="#{tecnica.nombreTecnica}" itemValue="#{tecnica.idTecnica}"/>
                                    </p:selectOneMenu>
                                    <p:column/>

                                    <h:outputLabel value="#{msg.lbl_production_status}" for="descripcionEstado" style="font-weight: bold"/>
                                    <p:selectOneMenu id="descripcionEstado" value="#{solicitanteBean.selectedEstadoPro}">  
                                        <f:selectItem itemLabel="Seleccione" itemValue="" />  
                                        <f:selectItems value="#{solicitanteBean.listEstadoPro}" var="estPro" itemLabel="#{estPro.descripcionEstado}" itemValue="#{estPro.idEstadoProduccion}" />
                                    </p:selectOneMenu>
                                    <p:column/>  

                                    <h:outputLabel value="#{msg.lbl_problem_detail}" for="descripcionProblema" style="font-weight: bold"/>
                                    <p:inputTextarea id="descripcionProblema" rows="10" cols="80" required="true" requiredMessage="#{msg.wrn_problem_detail_required}"   autoResize="false" value="#{solicitanteBean.descripcion}" />
                                    <p:column/> 
                                </h:panelGrid>
                            </p:panel>
                        </p:tab>  

                        <p:tab id="contact" title="#{msg.title_multimedia_inf}"> 
                            <p:panel header="#{msg.title_multimedia_inf}">  
                                <h:form enctype="multipart/form-data" id="form_file">  
                                    <p:messages id="msfile" showDetail="true"/>
                                    <p:outputLabel value="#{msg.lbl_multimedia_help}" />
                                    <br/>
                                    <p:outputLabel value="#{msg.lbl_multimedia_help_2}" />
                                    <br/>
                                    <br/>
                                    <p:lightBox styleClass="imagebox">  
                                        <h:outputLink value="#{appBean.baseURL}resources/gfx/example-1.JPG"  title="Fruto Sano">  
                                            <p:graphicImage value="#{appBean.baseURL}resources/gfx/example-1.JPG"/>  
                                        </h:outputLink>  
                                        <p:spacer/>
                                        <h:outputLink value="#{appBean.baseURL}resources/gfx/example-2.JPG" title="phitophtora">  
                                            <p:graphicImage value="#{appBean.baseURL}resources/gfx/example-2.JPG" />  
                                        </h:outputLink>  
                                        <p:spacer/>
                                        <h:outputLink value="#{appBean.baseURL}resources/gfx/example-3.JPG" title="Monilia">  
                                            <p:graphicImage value="#{appBean.baseURL}resources/gfx/example-3.JPG"/>  
                                        </h:outputLink>  
                                        <p:spacer/>
                                        <h:outputLink value="#{appBean.baseURL}resources/gfx/example-4.JPG" title="Escoba de bruja">  
                                            <p:graphicImage value="#{appBean.baseURL}resources/gfx/example-4.JPG"/>  
                                        </h:outputLink>  
                                    </p:lightBox>
                                    <br/>
                                    <br/>
                                    <p:fileUpload fileUploadListener="#{solicitanteBean.uploadToTmpUserFolder}"  
                                                  mode="advanced"  
                                                  update="msfile"   
                                                  multiple="true"  
                                                  sizeLimit="1000000"   
                                                  cancelLabel="Cancelar"
                                                  invalidFileMessage="#{msg.lbl_image_no_suport}"
                                                  invalidSizeMessage="#{msg.lbl_image_no_size_suport}"
                                                  fileLimitMessage="#{msg.lbl_image_number_file_exceded}"
                                                  required="true"
                                                  requiredMessage="#{msg.lbl_image_min_file}"
                                                  uploadLabel="#{msg.lbl_upload_image}"
                                                  label="#{msg.selection_to}"
                                                  fileLimit="4"
                                                  allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                                  />  
                                </h:form>
                                <br/>
                                <p:outputLabel value="#{msg.lbl_end_request_process}" />
                                <br/>
                                <br/>
                                <p:commandButton value="#{msg.save}" icon="ui-icon-disk" update="panel" 
                                                 actionListener="#{solicitanteBean.saveInfoSolicitante}" title="#{msg.lbl_help_save_request}" oncomplete="handleSubmitRequest(xhr, status, args)"/>  
                            </p:panel>                                                               
                        </p:tab>  
                    </p:wizard>  
                </h:form>
                <h:form id="form_result">
                    <p:confirmDialog id="resultDialog" message="#{msg.lbl_request_serial}"  severity="alert" widgetVar="dialogResult" showEffect="fade" hideEffect="clip" closable="false">
                        <h:panelGrid id="display" columns="1" cellpadding="4" style="margin:0 auto;"> 
                            <h:outputText id="serialResult" value="" />    
                            <p:commandButton id="comfirm" value="#{msg.yes}" action="#{solicitanteBean.closeRegistro}"   icon="ui-icon-check" />
                        </h:panelGrid>
                    </p:confirmDialog>    
                </h:form>
                <script type="text/javascript">
                    function handleSubmitRequest(xhr, status, args) {
                        if (args.serial != null) {
                            $('[id="form_result:serialResult"]').text(args.serial);
                            dialogResult.show();
                        }
                    }
                </script>
            </ui:define>

        </ui:composition>

    </body>
</html>
